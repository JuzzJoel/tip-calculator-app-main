<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- displays site properly based on user's device -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@700" rel="stylesheet">
  <link rel="icon" type="image/png" sizes="32x32" href="./images/favicon-32x32.png">

  <title>Frontend Mentor | Tip calculator app</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sass.js/0.10.10/sass.sync.min.js"></script>
  <style>
    *,
    *::before,
    *::after {
      box-sizing: border-box;
      font-family: var(--ff)
    }

    * {
      margin: 0;
      padding: 0;
      font-weight: 700
    }

    :root {
      --primary: hsl(183, 100%, 15%);
      --primary-alt: hsl(172, 67%, 45%);
      --Grey-1000: hsl(186, 14%, 43%);
      --Grey-800: hsl(184, 14%, 56%);
      --Grey-400: hsl(185, 41%, 84%);
      --Grey-100: hsl(189, 47%, 97%);
      --White: hsl(0, 100%, 100%);
      --fw-bold: 700;
      --ff: 'Space Mono', monospace
    }

    .attribution {
      font-size: 11px;
      text-align: center
    }

    .attribution a {
      color: #3e52a3
    }

    body {
      width: 100vw;
      height: auto;
      font-family: 'Space Mono', monospace;
      font-weight: 700;
      background: var(--Grey-400);
      flex-direction: column;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column
    }

    body *,
    body>*,
    button {
      font-weight: 700
    }

    .container {
      display: flex;
      flex-direction: column;
      width: 65%;
      height: auto
    }

    .logo {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      background: var(--Grey-400);
      height: 20vh
    }

    .calculator {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: row;
      border-radius: 2rem;
      box-shadow: 0 0 0.5rem 0 rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0 0 1rem rgba(0, 0, 0, 0.1));
      height: auto;
      overflow: hidden;
      height: 65vh;
      background: var(--White)
    }

    .calculator>* {
      width: 50%
    }

    .options-container {
      border-top-left-radius: 2rem;
      border-bottom-left-radius: 2rem
    }

    .tips-container {
      border-top-right-radius: 2rem;
      border-bottom-right-radius: 2rem
    }

    .options-container,
    .tips-container {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      height: 90%
    }

    .options,
    .tips-display {
      width: 90%;
      display: flex;
      align-items: none;
      justify-content: space-evenly;
      flex-direction: column;
      height: 100%
    }

    .tips-display {
      background: var(--primary);
      border-radius: 0.9rem;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column
    }

    .tips-display-container {
      width: 90%;
      height: 90%;
      background: inherit
    }

    .tip-select {
      display: flex;
      align-items: center;
      justify-content: space-evenly;
      flex-direction: column
    }

    .row {
      height: 100%;
      width: 100%;
      margin: 1rem;
      display: flex;
      flex-flow: row wrap;
      justify-content: space-between
    }

    .row>* {
      width: 33%;
      margin-bottom: 3%
    }

    label {
      font-size: 1rem;
      color: var(--Grey-1000);
      margin-bottom: 0.5rem
    }

    button {
      padding: .4rem 2rem;
      font-size: 1.5rem;
      background: var(--primary);
      border: none;
      color: var(--White);
      border-radius: 0.4rem;
      font-weight: 400;
      text-align: center;
      font-family: var(--ff);
      width: 100%;
      cursor: pointer;
      transition: color 0.3s ease, background 0.3s ease
    }

    button.active {
      background: var(--primary-alt);
      color: var(--primary)
    }

    button:hover {
      transform: translateY(1px)
    }

    .custom,
    .custom-input {
      background: var(--Grey-100);
      color: var(--Grey-1000);
      border: 3px solid transparent;
      transition: all 0.3s ease
    }

    .custom:hover,
    .custom:active {
      color: var(--primary);
      background: var(--White);
      border: 3px solid var(--Grey-400)
    }

    .reset {
      background: var(--Grey-1000);
      color: var(--primary);
      text-transform: uppercase
    }

    .reset:active {
      background: var(--primary);
      color: var(--primary);
      text-transform: uppercase
    }

    input {
      background: var(--Grey-100);
      border: 3px solid transparent;
      cursor: pointer;
      transition: all 0.3s ease-in-out;
      text-align: right;
      font-size: 1.5rem;
      color: var(--primary)
    }

    input:focus {
      border: 3px solid var(--primary-alt)
    }

    .bill-display,
    .amt-of-people {
      display: flex;
      flex-direction: column
    }

    .bill-display input,
    .amt-of-people input {
      position: relative;
      display: flex;
      padding: 1rem 2rem;
      border-radius: 0.4rem;
      text-indent: 10rem;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column
    }

    .bill-display input:focus,
    .amt-of-people input:focus {
      outline: none;
      caret-color: currentColor
    }

    .person-icon,
    .dollar-icon {
      position: absolute;
      transform: translate(100%, 200%);
      height: 27px
    }

    .reset-container {
      height: 50%;
      display: flex;
      align-items: center;
      justify-content: end;
      flex-direction: column
    }

    .tip-display-amount,
    .tip-display-total {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-direction: row;
      height: 25%
    }

    .tip-display-amount .pointer,
    .tip-display-total .pointer {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      color: var(--White)
    }

    .tip-display-amount .pointer .eyebrow,
    .tip-display-total .pointer .eyebrow {
      color: var(--Grey-400);
      font-size: 1rem
    }

    .display-figures {
      font-size: 3rem;
      color: var(--primary-alt);
      width: 75%;
      word-wrap: break-word;
      overflow-wrap: break-word;
      white-space: normal;
      text-align: right;
      display: flex;
      align-items: end;
      justify-content: flex-end;
      flex-direction: column
    }

    @media (max-width: 1100px) {
      body {
        height: auto
      }

      .container {
        width: 90vw;
        height: auto;
        flex-direction: column;
        justify-content: space-between
      }

      .logo {
        height: 15vh
      }

      .calculator {
        flex-direction: column;
        height: 100vh;
        border-radius: 1.5rem
      }

      .options-container {
        width: 100%;
        height: 60vh
      }

      .tips-container {
        height: 30vh;
        width: 100%
      }

      .options,
      .tips-display {
        height: 100%
      }

      .row {
        width: 100%
      }

      .row>* {
        width: 47%;
        margin-bottom: 5%
      }

      .tips-display-container {
        width: 90%;
        height: 90%
      }

      .display-figures {
        font-size: 2rem
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="logo">
      <img src="/images/logo.svg" alt="">
    </div>
    <div class="calculator">
      <div class="options-container">
        <div class="options">

          <div class="bill-display">

            <label for="bill">Bill</label>
            <input type="text" id="bill-input" class="bill">
            <img src="/images/icon-dollar.svg" class="dollar-icon" alt="dollar icon">
          </div>
          <div class="tip-select">
            <label for=""> Select Tip %</label>

            <div class="row">
              <button value="0.05">5%</button>
              <button value="0.1">10%</button>
              <button value="0.15">15%</button>
              <button value="0.25">25%</button>
              <button value="0.5">50%</button>
              <button class="custom" type="button" value="am the custom button">Custom</button>
            </div>

          </div>
          <div class="amt-of-people">
            <label for="people"> Number of People</label>
            <input type="text" id="people-input" class="people">
            <img src="/images/icon-person.svg" class="person-icon" alt="dollar icon">
          </div>

        </div>
      </div>


      <div class="tips-container">
        <div class="tips-display">
          <div class="tips-display-container">
            <div class="tip-display-amount">
              <div class="pointer">
                Tip Amount
                <span class="eyebrow">/ person</span>
              </div>
              <div class="display-figures" id="tip-amt">
                $0.00
              </div>
            </div>
            <div class="tip-display-total">
              <div class="pointer">
                Total
                <span class="eyebrow">/ person</span>
              </div>
              <div class="display-figures" id="tip-total">
                $0.00
              </div>
            </div>
            <div class="reset-container">
              <button class="reset" id="reset">
                Reset
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>



  <div class="attribution">
    Challenge by <a href="https://www.frontendmentor.io?ref=challenge" target="_blank">Frontend Mentor</a>.
    Coded by <a href="https://startbootstrap-personal.vercel.app">Olajire Joel</a>.
  </div>
</body>


<script>
  let customButton = document.querySelector(".custom");
  let billInput = document.querySelector("#bill-input");
  let peopleInput = document.querySelector("#people-input");
  let tipAmtDisplay = document.querySelector("#tip-amt");
  let tipTotalDisplay = document.querySelector("#tip-total");
  let resetAll = document.querySelector("#reset");
  let tipPercent = "";
  let numRegex = /^\d*\.?\d*$/;
  let positiveNumRegex = /^[1-9]\d*$/;
  let billRegex = /^\d*\.?\d+$/;
  let buttons = document.querySelectorAll(".tip-select button");
  let inputBox;
  let isInputBox = false;

  const toggleInputBox = () => {
    if (!isInputBox) {
      inputBox = document.createElement("input");
      inputBox.className = "custom-input";
      inputBox.type = "number";
      customButton.parentNode.replaceChild(inputBox, customButton);
      inputBox.focus();
      inputBox.addEventListener("input", () => {
        tipPercent = inputBox.value / 100;
        calculateTip();
      });
      inputBox.addEventListener("blur", () => {
        toggleInputBox();
      });
      isInputBox = true;
    } else {
      inputBox.parentNode.replaceChild(customButton, inputBox);
      isInputBox = false;
    }
  };

  customButton.addEventListener("click", toggleInputBox);


  billInput.addEventListener("input", () => {
    if (billRegex.test(billInput.value) && parseFloat(billInput.value) >= 0) {
      billInput.style.borderColor = "";
    } else if (billInput.value === "") {
      billInput.style.borderColor = "";
    }
    else {
      billInput.style.borderColor = "red";
    }
    calculateTip();
  });


  peopleInput.addEventListener("input", () => {
    const peopleValue = peopleInput.value;
    if (positiveNumRegex.test(peopleValue) && parseInt(peopleValue) > 0) {
      peopleInput.style.borderColor = "";
    } else if (peopleValue === "") {
      peopleInput.style.borderColor = "";
    }
    else {
      peopleInput.style.borderColor = "red";
    }
    calculateTip();
  });


  buttons.forEach((button) => {
    button.addEventListener("click", () => {
      buttons.forEach(btn => {
        if (!btn.classList.contains("custom")) {
          btn.classList.remove('active');
        }
      });

      if (button.classList.contains("custom")) {
        if (!isInputBox) {
          toggleInputBox();
          if (inputBox && inputBox.value && numRegex.test(inputBox.value)) {
            tipPercent = parseFloat(inputBox.value) / 100;
          } else if (inputBox) {
            inputBox.value = "";
            tipPercent = "";
          }
        } else {

          inputBox.focus();
        }
        customButton.classList.remove('active');
      } else {
        if (isInputBox) {
          toggleInputBox();
        }
        button.classList.add("active");
        tipPercent = parseFloat(button.value);
      }
      calculateTip();
    });
  });


  function calculateTip() {
    if (isInputBox && inputBox) {
      console.log("Custom input value for calculation:", inputBox.value);
    }

    const billVal = parseFloat(billInput.value);
    const peopleVal = parseInt(peopleInput.value);

    let billIsValid = !isNaN(billVal) && billVal >= 0 && billInput.style.borderColor !== "red";
    let peopleAreValid = !isNaN(peopleVal) && peopleVal > 0 && peopleInput.style.borderColor !== "red";
    let tipPercentIsValid = (typeof tipPercent === 'number' && tipPercent >= 0);

    if (billInput.value === "") billIsValid = true;
    if (peopleInput.value === "") peopleAreValid = true;
    if (billIsValid && peopleAreValid && tipPercentIsValid && billVal > 0 && peopleVal > 0) {
      let bill = parseFloat(billInput.value);
      let people = parseFloat(peopleInput.value);
      let tip = (bill * tipPercent);

      let totalBill = bill + tip;
      let tipPerPerson = (tip / people).toFixed(2);
      let totalPerPerson = (totalBill / people).toFixed(2);

      tipAmtDisplay.textContent = `$${tipPerPerson}`;
      tipTotalDisplay.textContent = `$${totalPerPerson}`;
    }
    else {
      if ((billInput.value !== "" && !billIsValid) || (peopleInput.value !== "" && !peopleAreValid)) {

        tipAmtDisplay.textContent = "$0.00";
        tipTotalDisplay.textContent = "$0.00";
      }
      else if (billVal === 0 && peopleVal > 0 && tipPercentIsValid) { // Edge case: $0 bill
        tipAmtDisplay.textContent = "$0.00";
        tipTotalDisplay.textContent = "$0.00";
      }
      else if (billInput.value === "" || peopleInput.value === "") {
        tipAmtDisplay.textContent = "$0.00";
        tipTotalDisplay.textContent = "$0.00";
      }
    }
    formatNumbers();
  }

  function formatNumbers() {
    let displayFigures = document.querySelectorAll('.display-figures');
    displayFigures.forEach((figure) => {
      let text = figure.textContent;
      if (text.length > 12) {
        let num = parseFloat(text.replace('$', ''));
        figure.textContent = `$${num.toExponential(2)}`;
      }
    });
  }

  resetAll.addEventListener(
    "click", () => {
      billInput.value = "";
      peopleInput.value = "";
      tipAmtDisplay.textContent = `$00.00`;
      tipTotalDisplay.textContent = `$00.00`;
      buttons.forEach((button) => {
        button.classList.remove("active");
      })
      tipPercent = "";
      if (isInputBox) {
        toggleInputBox();
      }
      billInput.style.borderColor = "";
      peopleInput.style.borderColor = "";
      if
        (inputBox) {
        inputBox.style.borderColor = "";
      }

    })
</script>

</html>